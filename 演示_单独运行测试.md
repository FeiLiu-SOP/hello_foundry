# æ¼”ç¤ºï¼šå¦‚ä½•å•ç‹¬è¿è¡Œå•ä¸ªæµ‹è¯•ç”¨ä¾‹

## ğŸ¯ æ ¸å¿ƒè¦ç‚¹

**æ¯ä¸ª `test_` å¼€å¤´çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥å•ç‹¬è¿è¡Œï¼**

## ğŸ“‹ æµ‹è¯•æ–‡ä»¶ä¸­çš„æµ‹è¯•ç”¨ä¾‹åˆ—è¡¨

åœ¨ `test/SimpleWallet.t.sol` ä¸­ï¼Œæœ‰ 7 ä¸ªç‹¬ç«‹çš„æµ‹è¯•ç”¨ä¾‹ï¼š

1. `test_NormalWithdraw_OwnerCanWithdraw()` - æ­£å¸¸æå–æµ‹è¯•
2. `test_Prank_SimulateOwner()` - ä½¿ç”¨ prank æ¨¡æ‹Ÿ owner
3. `test_Prank_SimulateHacker_ShouldFail()` - æ¨¡æ‹Ÿé»‘å®¢æ”»å‡»ï¼ˆåº”è¯¥å¤±è´¥ï¼‰
4. `test_Prank_SimulateWhale_ShouldFail()` - æ¨¡æ‹Ÿå¤§æˆ·ï¼ˆåº”è¯¥å¤±è´¥ï¼‰
5. `test_Prank_OnlyAffectsNextLine()` - prank åªå½±å“ä¸‹ä¸€è¡Œ
6. `test_Prank_MultiplePranks()` - è¿ç»­ä½¿ç”¨å¤šä¸ª prank
7. `test_WithoutPrank_TestContractIsCaller()` - ä¸ä½¿ç”¨ prank çš„æƒ…å†µ

## ğŸš€ å®é™…è¿è¡Œç¤ºä¾‹

### ç¤ºä¾‹1ï¼šåªè¿è¡Œ test_Prank_SimulateHacker_ShouldFail

```bash
forge test --match-test test_Prank_SimulateHacker_ShouldFail -vvv
```

**è¾“å‡ºä¼šæ˜¾ç¤ºï¼š**
```
Running 1 test for test/SimpleWallet.t.sol:SimpleWalletTest
[PASS] test_Prank_SimulateHacker_ShouldFail() (gas: 12345)
Test result: ok. 1 passed; 0 failed; finished in 0.01s
```

### ç¤ºä¾‹2ï¼šåªè¿è¡Œ test_Prank_SimulateOwner

```bash
forge test --match-test test_Prank_SimulateOwner -vvv
```

### ç¤ºä¾‹3ï¼šè¿è¡Œæ‰€æœ‰ test_Prank å¼€å¤´çš„æµ‹è¯•

```bash
forge test --match-test "test_Prank.*" -vv
```

è¿™ä¼šè¿è¡Œï¼š
- test_Prank_SimulateOwner
- test_Prank_SimulateHacker_ShouldFail
- test_Prank_SimulateWhale_ShouldFail
- test_Prank_OnlyAffectsNextLine
- test_Prank_MultiplePranks

### ç¤ºä¾‹4ï¼šæœ€ç²¾ç¡®çš„ç»„åˆ

```bash
# åœ¨ SimpleWallet.t.sol æ–‡ä»¶ä¸­ï¼Œåªè¿è¡Œ test_Prank_SimulateHacker_ShouldFail
forge test --match-path test/SimpleWallet.t.sol --match-test test_Prank_SimulateHacker_ShouldFail -vvv
```

## ğŸ” å¯¹æ¯”ï¼šJava vs Foundry

### Java (JUnit)
```java
@Test
void testCreateUser() { ... }  // å³é”® -> Run 'testCreateUser()'
```

### Foundry
```solidity
function test_Prank_SimulateHacker() public { ... }  // forge test --match-test test_Prank_SimulateHacker
```

**ä¸¤è€…æœ¬è´¨ç›¸åŒï¼** éƒ½æ˜¯å¯ä»¥å•ç‹¬è¿è¡Œçš„æµ‹è¯•ç”¨ä¾‹ã€‚

## ğŸ’¡ å·¥ä½œä¸­çš„å®é™…ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šä½ æ­£åœ¨å†™ä¸€ä¸ªæ–°æµ‹è¯•

```bash
# 1. å†™æµ‹è¯•ä»£ç 
# 2. åªè¿è¡Œè¿™ä¸ªæµ‹è¯•ï¼Œå¿«é€ŸéªŒè¯
forge test --match-test test_ä½ çš„æ–°æµ‹è¯•å -vvv

# 3. å¦‚æœå¤±è´¥ï¼Œä¿®æ”¹ä»£ç ï¼Œå†æ¬¡è¿è¡Œ
forge test --match-test test_ä½ çš„æ–°æµ‹è¯•å -vvv

# 4. é‡å¤ç›´åˆ°é€šè¿‡
```

### åœºæ™¯2ï¼šæŸä¸ªæµ‹è¯•å¤±è´¥äº†ï¼Œä½ æƒ³è°ƒè¯•

```bash
# åªè¿è¡Œå¤±è´¥çš„æµ‹è¯•ï¼ŒæŸ¥çœ‹è¯¦ç»†æ—¥å¿—
forge test --match-test test_Prank_SimulateHacker_ShouldFail -vvvv

# -vvvv ä¼šæ˜¾ç¤ºï¼š
# - å®Œæ•´çš„è°ƒç”¨æ ˆ
# - æ¯ä¸€æ­¥çš„ gas æ¶ˆè€—
# - revert çš„è¯¦ç»†åŸå› 
# - æ‰€æœ‰çŠ¶æ€å˜åŒ–
```

### åœºæ™¯3ï¼šä½ æƒ³æµ‹è¯•æŸä¸ªåŠŸèƒ½çš„æ‰€æœ‰ç›¸å…³æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰ prank ç›¸å…³çš„æµ‹è¯•
forge test --match-test "test_Prank.*" -vv

# è¿è¡Œæ‰€æœ‰ withdraw ç›¸å…³çš„æµ‹è¯•
forge test --match-test ".*Withdraw.*" -vv
```

## ğŸ“Š å‘½ä»¤å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--match-test` | åŒ¹é…æµ‹è¯•å‡½æ•°å | `--match-test test_Prank_SimulateHacker` |
| `--match-path` | åŒ¹é…æ–‡ä»¶è·¯å¾„ | `--match-path test/SimpleWallet.t.sol` |
| `--match-contract` | åŒ¹é…åˆçº¦å | `--match-contract SimpleWalletTest` |
| `-v` | åŸºæœ¬è¾“å‡º | æ˜¾ç¤ºæµ‹è¯•ç»“æœ |
| `-vv` | è¯¦ç»†è¾“å‡º | æ˜¾ç¤ºæµ‹è¯•ç»“æœ + å¤±è´¥åŸå›  |
| `-vvv` | æ›´è¯¦ç»†è¾“å‡º | æ˜¾ç¤ºæµ‹è¯•ç»“æœ + å¤±è´¥åŸå›  + è°ƒç”¨æ ˆ |
| `-vvvv` | æœ€è¯¦ç»†è¾“å‡º | æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬ gas |

## âœ… æ€»ç»“

1. **æ¯ä¸ª `test_` å‡½æ•°éƒ½æ˜¯ç‹¬ç«‹çš„æµ‹è¯•ç”¨ä¾‹**
2. **å¯ä»¥ä½¿ç”¨ `--match-test` å•ç‹¬è¿è¡Œä»»ä½•ä¸€ä¸ªæµ‹è¯•**
3. **æµ‹è¯•ä¹‹é—´å®Œå…¨éš”ç¦»**ï¼ˆæ¯ä¸ªæµ‹è¯•å‰éƒ½ä¼šé‡æ–° setUpï¼‰
4. **å·¥ä½œä¸­å¸¸ç”¨**ï¼šå¼€å‘æ—¶åªè¿è¡Œå½“å‰æµ‹è¯•ï¼Œæäº¤å‰è¿è¡Œæ‰€æœ‰æµ‹è¯•
